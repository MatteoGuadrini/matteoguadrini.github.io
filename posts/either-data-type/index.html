<!DOCTYPE html>
<html>
  <head>
    
    
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      
  Either Data Type &ndash; DevOps journey

    </title>
    
    <meta content="either, datatype" name="keywords">
    
    
    <meta name="description" property="og:description" content="A new data type Before talking about the Either data type, we need to know what a data type is.
A data type is an abstraction that encapsulates one reusable coding pattern.
In our case, the Either data type encapsulates two other objects: Left and Right. These two objects represent Error and Success respectively.
This is a common pattern for Functional Programming.
Left and Right Left and Right, are classes wich represent the error and success data.|">
    

    <meta name="apple-mobile-web-app-title" content="DevOps journey">
    
    
    <link rel="icon" href="https://matteoguadrini.github.iofavicon-64.png">
    <link rel="apple-touch-icon" href="https://matteoguadrini.github.ioapple-touch-icon.png">
    <link rel="mask-icon" size="any" href="https://matteoguadrini.github.iopinned-icon.svg">
    
    
    


    <link rel="stylesheet" href="/assets/syntax.css">
    <link rel="stylesheet" href="/assets/primer-build.css">
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="/assets/custom_style.css">
  </head>


  <body class="bg-gray">
    <div id="holy" class="container-lg bg-white h-100">

      <div id="header" class="px-1 bg-white">
        <nav class="UnderlineNav UnderlineNav--right px-2">
  <a class="UnderlineNav-actions muted-link h2" href="https://matteoguadrini.github.io">
    DevOps journey
  </a>

  
  
  <div class="UnderlineNav-body">
    
    
    
    <a class="UnderlineNav-item" href="/about/">
      
      <span>About</span>
    </a>
    
    
    
    
    <a class="UnderlineNav-item" href="/tools/">
      
      <span>Tools</span>
    </a>
    
    
  </div>
  
</nav>

      </div>

      <div role="main" id="main" class="holy-main markdown-body px-4 bg-white">
        

<div class="Subhead">
  <div class="Subhead-heading">
    <div class="h1 mt-3 mb-1">Either Data Type</div>
  </div>
  <div class="Subhead-description">
    


<a href='/categories/develop' class="muted-link">
  <span class="Label Label--gray-darker">develop</span>
</a>



<a href='/tags/python' class="muted-link">
  <span class="Label Label--gray">python</span>
</a>

<a href='/tags/kotlin' class="muted-link">
  <span class="Label Label--gray">kotlin</span>
</a>



    
    <div class="float-md-right">
      <span title="Lastmod: 2021-08-01. Published at: 2021-08-01.">
        
          Published: 2021-08-01
        
      </span>
    </div>
    
  </div>
</div>
<article>
  
  <section class="pb-6 mb-3 border-bottom">
    <p><img src="https://insights-images.thoughtworks.com/The20Either20datatype20as20an20alternative20to20throwing20exceptions2_0_b3d7c0ea43017def815a54004a7db6f2.png" alt="Either"></p>
<h2 id="a-new-data-type">A new data type</h2>
<p>Before talking about the <strong>Either</strong> data type, we need to know what a data type is.</p>
<p>A data type is an abstraction that encapsulates one reusable coding pattern.</p>
<p>In our case, the <em>Either</em> data type encapsulates two other objects: <em>Left</em> and <em>Right</em>. These two objects represent Error and Success respectively.</p>
<p>This is a common pattern for <a href="https://en.wikipedia.org/wiki/Functional_programming">Functional Programming</a>.</p>
<h3 id="left-and-right">Left and Right</h3>
<p>Left and Right, are classes wich represent the error and success data. Therefore one of the two attributes will always be valued.
This is an example done in the Kotlin language:</p>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">sealed</span> <span class="k">class</span> <span class="nc">Either</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">L</span><span class="p">,</span> <span class="k">out</span> <span class="n">R</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">data</span> <span class="k">class</span> <span class="nc">Left</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">L</span><span class="p">,</span> <span class="k">out</span> <span class="n">R</span><span class="p">&gt;(</span><span class="k">val</span> <span class="py">a</span><span class="p">:</span> <span class="n">L</span><span class="p">)</span> <span class="p">:</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">&gt;()</span>
    <span class="k">data</span> <span class="k">class</span> <span class="nc">Right</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">L</span><span class="p">,</span> <span class="k">out</span> <span class="n">R</span><span class="p">&gt;(</span><span class="k">val</span> <span class="py">b</span><span class="p">:</span> <span class="n">R</span><span class="p">)</span> <span class="p">:</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">&gt;()</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="p">&lt;</span><span class="nc">E</span><span class="p">&gt;</span> <span class="nf">E</span><span class="p">.</span><span class="n">left</span><span class="p">()</span> <span class="p">=</span> <span class="n">Either</span><span class="p">.</span><span class="n">Left</span><span class="p">&lt;</span><span class="n">E</span><span class="p">,</span> <span class="n">Nothing</span><span class="p">&gt;(</span><span class="k">this</span><span class="p">)</span>
<span class="k">fun</span> <span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;</span> <span class="nf">T</span><span class="p">.</span><span class="n">right</span><span class="p">()</span> <span class="p">=</span> <span class="n">Either</span><span class="p">.</span><span class="n">Right</span><span class="p">&lt;</span><span class="n">Nothing</span><span class="p">,</span> <span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span><span class="p">)</span>
</code></pre></div><p>This way we can return our object to directly encapsulate a valid result or an exception without stopping execution in case of an error.</p>
<h3 id="apply-either-type">Apply Either type</h3>
<p>Suppose we have written a Verifier class, which checks the veracity of a JWT token. At this point, instead of returning a result or throwing an exception in case of error, we return an Either type.</p>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">interface</span> <span class="nc">Verifier</span> <span class="p">{</span>
    <span class="p">/</span> <span class="p">**</span>
     <span class="p">*</span> <span class="nd">@param</span> <span class="n">jwt</span> <span class="n">a</span> <span class="n">jwt</span> <span class="n">token</span>
     <span class="p">*</span> <span class="nd">@return</span> <span class="n">authentication</span> <span class="n">credentials</span><span class="p">,</span> <span class="n">or</span> <span class="n">an</span> <span class="n">error</span> <span class="k">if</span> <span class="n">the</span> <span class="n">validation</span> <span class="n">fails</span>
     <span class="p">*</span> <span class="p">/</span>

    <span class="k">fun</span> <span class="nf">verify</span><span class="p">(</span><span class="n">jwt</span><span class="p">:</span> <span class="n">String</span><span class="p">):</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">JWTVerificationException</span><span class="p">,</span> <span class="n">TokenAuthentication</span><span class="p">&gt;</span>
<span class="p">}</span>
</code></pre></div><p>Inside our implementation of <em>Verifier</em>, weâ€™re wrapping the problematic code with an extension method called <em>unsafeVerify</em>. We use the extension methods that we defined above to create both sides of an <em>Either</em>:</p>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">private</span> <span class="k">fun</span> <span class="nf">JWTVerifier</span><span class="p">.</span><span class="n">unsafeVerify</span><span class="p">(</span><span class="n">jwt</span><span class="p">:</span> <span class="n">String</span><span class="p">):</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">JWTVerificationException</span><span class="p">,</span> <span class="n">TokenAuthentication</span><span class="p">&gt;</span> <span class="p">=</span> <span class="k">try</span> <span class="p">{</span>
    <span class="n">verifyByCallingExternalApi</span><span class="p">(</span><span class="n">jwt</span><span class="p">).</span><span class="n">right</span><span class="p">()</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="n">JWTVerificationException</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="n">left</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>We can use a when expression thanks to having defined our <em>Either</em> as a sealed class.</p>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">val</span> <span class="py">result</span> <span class="p">=</span> <span class="n">verifier</span><span class="p">.</span><span class="n">verify</span><span class="p">(</span><span class="n">jwt</span><span class="p">)</span>
<span class="k">when</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="n">Either</span><span class="p">.</span><span class="n">Left</span> <span class="o">-&gt;</span> <span class="n">ResponseEntity</span><span class="p">.</span><span class="n">badRequest</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
    <span class="k">is</span> <span class="n">Either</span><span class="p">.</span><span class="n">Right</span> <span class="o">-&gt;</span> <span class="n">ResponseEntity</span><span class="p">.</span><span class="n">ok</span><span class="p">(</span><span class="s2">&#34;Worked!&#34;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><h2 id="pyeither">Py&hellip;Either</h2>
<p>Python doesn&rsquo;t have a type like <em>Either</em>, but we can implement it so that with every exception, we can create our own Either type.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Either</span><span class="p">:</span>
    <span class="s2">&#34;&#34;&#34;
</span><span class="s2">    Either is an entity whose value can be of two different types,
</span><span class="s2">    called left and right. By convention, Right is for the success case and
</span><span class="s2">    Left for the error one. Itâ€™s a common pattern in the functional community.
</span><span class="s2">    It allows us to express the fact that a call might return a correct value
</span><span class="s2">    or an error, and differentiate between the two of them. The Left/Right
</span><span class="s2">    naming pattern is just a convention, though. It can help people who have
</span><span class="s2">    used the nomenclature in existing libraries. You can use a different
</span><span class="s2">    convention that makes more sense for your team, such as Error/Success,
</span><span class="s2">    for instance.
</span><span class="s2">    &#34;&#34;&#34;</span>

    <span class="k">class</span> <span class="nc">Left</span><span class="p">:</span>
        <span class="s2">&#34;&#34;&#34;
</span><span class="s2">        Default exception in either data type
</span><span class="s2">        &#34;&#34;&#34;</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="n">error</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span><span class="s1">&#39;{self.error}&#39;</span>

        <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>


    <span class="k">class</span> <span class="nc">Right</span><span class="p">:</span>
        <span class="s2">&#34;&#34;&#34;
</span><span class="s2">        Default return value in either data type
</span><span class="s2">        &#34;&#34;&#34;</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">result</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span><span class="s1">&#39;{self.data}&#39;</span>

        <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">:</span> <span class="n">Either</span><span class="o">.</span><span class="n">Left</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="n">Either</span><span class="o">.</span><span class="n">Right</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&#34;&lt;Either object, right={self.right.data}, left={self.left.error}&gt;&#34;</span>

    <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
</code></pre></div><p>At this point, we have an object capable of saving itself from the state of exception and success. Let&rsquo;s test it!</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">try</span><span class="p">:</span>
	<span class="n">final</span> <span class="o">=</span> <span class="n">Either</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">some_func</span><span class="p">(</span><span class="n">some_args</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
	<span class="n">final</span> <span class="o">=</span> <span class="n">Either</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
</code></pre></div><p>At this point, we can build this type of control in the statement of our functions (or with specific exceptions).</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">my_func</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="n">either</span> <span class="o">=</span> <span class="n">Either</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">(</span><span class="n">number</span> <span class="o">//</span> <span class="mi">0</span><span class="p">))</span>
	<span class="k">except</span> <span class="ne">ZeroDivisionError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
		<span class="n">either</span> <span class="o">=</span> <span class="n">Either</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">either</span>
</code></pre></div><p>In this way our function will always return an Either data type.</p>
<h2 id="conclusion">Conclusion</h2>
<p>This new type of object is changing the way programs are written, in order to handle or not handle certain errors. For example, server or web applications must somehow handle the exceptions that arrive and continue their work.
With an Either type available, these types of applications can never be interrupted by user exceptions and allow the developer to intercept what needs to be changed.
This new type of data is introduced in new programming languages such as <em>Go</em>, <em>Rust</em> and <em>Kotlin</em>, but we have seen that it is possible to implement it even where it is not native as in <em>python</em>, adapting our objects and our functions to return a very efficient <strong>Either data type</strong>.</p>

  </section>

  <section>
    
      
    
  </section>
</article>

      </div>

      <div id="side" class="pr-1 bg-white">
        <aside class="pr-3">
          
  
    <div id="toc" class="Box Box--blue mb-3">
      <b>Either Data Type</b><nav id="TableOfContents">
  <ul>
    <li><a href="#a-new-data-type">A new data type</a>
      <ul>
        <li><a href="#left-and-right">Left and Right</a></li>
        <li><a href="#apply-either-type">Apply Either type</a></li>
      </ul>
    </li>
    <li><a href="#pyeither">Py&hellip;Either</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav></div>
  

  
    
    
      <div>
        
          <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        

        
          <iframe src="https://www.facebook.com/plugins/share_button.php?href=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&layout=button&size=small&mobile_iframe=true&width=61&height=20&appId" width="61" height="20" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true" allow="encrypted-media"></iframe>
        

        

        
          <a data-pocket-label="pocket" data-pocket-count="none" class="pocket-btn" data-lang="en"></a>
          <script type="text/javascript">!function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");</script>
        

      </div>
    
  

        </aside>
      </div>

      <div id="footer" class="pt-2 pb-3 bg-white text-center">
        

  <span class="text-small text-gray">
    Â© Matteo Guadrini &middot; 

    Powered by the
    <a href="https://github.com/qqhann/hugo-primer" class="link-gray-dark">Hugo-Primer</a> theme for
    <a href="https://gohugo.io" class="link-gray-dark">Hugo</a>.
  </span>


      </div>
    </div>

    
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>
    
  </body>
</html>
