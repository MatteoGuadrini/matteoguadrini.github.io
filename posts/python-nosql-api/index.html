<!DOCTYPE html>
<html>
  <head>
    
    
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      
  Python NOSQL Api &ndash; DevOps journey

    </title>
    
    <meta content="python, database, nosql, api, web" name="keywords">
    
    
    <meta name="description" property="og:description" content="The world of databases is truly vast. But it is governed by a standard that respects the SQL language API. But there is another world; that of NOSQL databases.
A little tidy There are four types of NOSQL databases:
 Key/Value database Column database Document database Graph database  These four types of databases, unfortunately, do not respond to any API and the various libraries, such as the python ones, have various objects and various methods for extracting and inserting data.|">
    

    <meta name="apple-mobile-web-app-title" content="DevOps journey">
    
    
    <link rel="icon" href="https://matteoguadrini.github.iofavicon-64.png">
    <link rel="apple-touch-icon" href="https://matteoguadrini.github.ioapple-touch-icon.png">
    <link rel="mask-icon" size="any" href="https://matteoguadrini.github.iopinned-icon.svg">
    
    
    


    <link rel="stylesheet" href="/assets/syntax.css">
    <link rel="stylesheet" href="/assets/primer-build.css">
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="/assets/custom_style.css">
  </head>


  <body class="bg-gray">
    <div id="holy" class="container-lg bg-white h-100">

      <div id="header" class="px-1 bg-white">
        <nav class="UnderlineNav UnderlineNav--right px-2">
  <a class="UnderlineNav-actions muted-link h2" href="https://matteoguadrini.github.io">
    DevOps journey
  </a>

  
  
  <div class="UnderlineNav-body">
    
    
    
    <a class="UnderlineNav-item" href="/about/">
      
      <span>About</span>
    </a>
    
    
    
    
    <a class="UnderlineNav-item" href="/tools/">
      
      <span>Tools</span>
    </a>
    
    
  </div>
  
</nav>

      </div>

      <div role="main" id="main" class="holy-main markdown-body px-4 bg-white">
        

<div class="Subhead">
  <div class="Subhead-heading">
    <div class="h1 mt-3 mb-1">Python NOSQL Api</div>
  </div>
  <div class="Subhead-description">
    


<a href='/categories/python' class="muted-link">
  <span class="Label Label--gray-darker">python</span>
</a>



<a href='/tags/nosql' class="muted-link">
  <span class="Label Label--gray">nosql</span>
</a>

<a href='/tags/api' class="muted-link">
  <span class="Label Label--gray">api</span>
</a>

<a href='/tags/python' class="muted-link">
  <span class="Label Label--gray">python</span>
</a>



    
    <div class="float-md-right">
      <span title="Lastmod: 2022-09-04. Published at: 2022-09-04.">
        
          Published: 2022-09-04
        
      </span>
    </div>
    
  </div>
</div>
<article>
  
  <section class="pb-6 mb-3 border-bottom">
    <p>The world of databases is truly vast. But it is governed by a standard that respects the SQL language API. But there is another world; that of <strong>NOSQL</strong> databases.</p>
<h2 id="a-little-tidy">A little tidy</h2>
<p>There are four types of <em>NOSQL</em> databases:</p>
<ul>
<li><em>Key/Value database</em></li>
<li><em>Column database</em></li>
<li><em>Document database</em></li>
<li><em>Graph database</em></li>
</ul>
<p>These four types of databases, unfortunately, do not respond to any <em>API</em> and the various libraries, such as the python ones, have various objects and various methods for extracting and inserting data.</p>
<p>For this reason, I decided to create these APIs across the various database types, in order to have consistent names for each database type.</p>
<h2 id="a-simple-interface">A simple interface</h2>
<p>Python SQL libraries have a standard defined in <a href="https://peps.python.org/pep-0249/">PEP 249</a>, which describes what method and object names a library must have.
In this way, all methods in libraries that respect this API are called the same way.
<a href="https://github.com/MatteoGuadrini/nosqlapi">nosqlapi</a> defines the interfaces to build a suitable and consistent library for all <em>NOSQL</em> database types listed above.</p>
<h2 id="api">API</h2>
<p>All four types of databases are different from each other but still have similarities. Anyone can enter data, make updates, delete data and search within. In short, they mirror all <em>CRUD (<strong>C</strong>reate <strong>R</strong>ead <strong>U</strong>pdate <strong>D</strong>elete)</em> operations.</p>
<p>Furthermore, all four can mirror two objects that host two layers important for these operations: the <strong>Connection</strong> and the <strong>Session</strong>.</p>
<h3 id="connection">Connection</h3>
<p>The <strong>Connection</strong> focuses on how to connect to the database and how to interact where the data will be stored on the server. Operations such as connecting, disconnecting, creating databases and more.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># My database library built-in with nosqlapi package</span>
<span class="kn">from</span> <span class="nn">my_nosqlapi_module</span> <span class="kn">import</span> <span class="n">Connection</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;myserve.local&#39;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;passw00rd&#39;</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">databases</span><span class="p">()</span>                    <span class="c1"># list of all database</span>
<span class="n">conn</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="s1">&#39;new_db&#39;</span><span class="p">)</span>      <span class="c1"># new database</span>
<span class="n">conn</span><span class="o">.</span><span class="n">delete_database</span><span class="p">(</span><span class="s1">&#39;new_db&#39;</span><span class="p">)</span>      <span class="c1"># delete database</span>
</code></pre></div><p>All possible operations in the <em>Connection</em> are performed in the context of the databases.</p>
<h3 id="session">Session</h3>
<p>Once a <em>NOSQL</em> server is connected, you need to create a session to work directly with the data. This is done via a <strong>Session</strong> object.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># My database library built-in with nosqlapi package</span>
<span class="kn">from</span> <span class="nn">my_nosqlapi_module</span> <span class="kn">import</span> <span class="n">Connection</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;myserve.local&#39;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;passw00rd&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;db&#39;</span><span class="p">)</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>                   <span class="c1"># Session object</span>

<span class="c1"># CRUD operation</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>         <span class="c1"># Create</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>                     <span class="c1"># Read</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;new_value&#39;</span><span class="p">)</span>     <span class="c1"># Update</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>                  <span class="c1"># Delete</span>
</code></pre></div><p>In the previous example, the database in question is a <em>key-value database</em>, like <em>Redis</em>, but the interface expects the same names for the other types as well.</p>
<h3 id="other-objects">Other objects</h3>
<p>In the world of SQL databases, there are libraries that map python database objects as if they were database objects. These libraries are called <em>Object-relational mapping (ORM)</em>.
In the world of NOSQL, being non-relational, there is a different kind of approach.
noslapi also offers <em>ODM (Object-data mappings)</em>, which transport the objects of the various NOSQL databases into the python world with ease.</p>
<pre tabindex="0"><code class="language-pycon" data-lang="pycon">&gt;&gt;&gt; import nosqlapi.common.odm
&gt;&gt;&gt; [t for t in dir(nosqlapi.common.odm) if not t.startswith('__')]
['Array', 'Ascii', 'Blob', 'Boolean', 'Counter', 'Date', 'Dc', 'Decimal', 'Double', 'Duration', 'Float', 'Inet', 'Int', 
'List', 'Map', 'Null', 'SmallInt', 'Text', 'Time', 'Timestamp', 'Uuid', 'Varchar']
</code></pre><h3 id="backword-compatibility">Backword compatibility</h3>
<p><em>nosqlapi</em> also offers a decorator to bring existing libraries (which have all methods of doing the same operations but with different names) to the standard of names offered by the same library.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">nosqlapi</span>
<span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">Connection</span>

<span class="c1"># This decorator allows you to map existing method names to API compliant methods.</span>
<span class="nd">@nosqlapi</span><span class="o">.</span><span class="n">api</span><span class="p">(</span><span class="n">database_names</span><span class="o">=</span><span class="s1">&#39;databases&#39;</span><span class="p">,</span> <span class="n">drop_database</span><span class="o">=</span><span class="s1">&#39;delete_database&#39;</span><span class="p">,</span> <span class="n">close_cursor</span><span class="o">=</span><span class="s1">&#39;close&#39;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ApiConnection</span><span class="p">(</span><span class="n">Connection</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">ApiConnection</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">27017</span><span class="p">,</span> <span class="s1">&#39;test_database&#39;</span><span class="p">)</span>
<span class="nb">hasattr</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s1">&#39;databases&#39;</span><span class="p">)</span>      <span class="c1"># True</span>
<span class="n">conn</span><span class="o">.</span><span class="n">databases</span><span class="p">()</span>                <span class="c1"># (test_database, &#39;db1&#39;, &#39;db2&#39;)</span>
</code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>Thanks to this library, it is possible to have python libraries (but not only) consistent with an API, which in turn allows to have consistency between the various libraries as if it were an SQL database.
Of course, there is extensive <a href="https://nosqlapi.readthedocs.io/en/latest">documentation</a> for building your own library and <a href="https://github.com/MatteoGuadrini/nosqlapi/tree/main/tests">examples</a> on pre-made libraries.</p>

  </section>

  <section>
    
      
    
  </section>
</article>

      </div>

      <div id="side" class="pr-1 bg-white">
        <aside class="pr-3">
          
  
    <div id="toc" class="Box Box--blue mb-3">
      <b>Python NOSQL Api</b><nav id="TableOfContents">
  <ul>
    <li><a href="#a-little-tidy">A little tidy</a></li>
    <li><a href="#a-simple-interface">A simple interface</a></li>
    <li><a href="#api">API</a>
      <ul>
        <li><a href="#connection">Connection</a></li>
        <li><a href="#session">Session</a></li>
        <li><a href="#other-objects">Other objects</a></li>
        <li><a href="#backword-compatibility">Backword compatibility</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav></div>
  

  
    
    
      <div>
        
          <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        

        
          <iframe src="https://www.facebook.com/plugins/share_button.php?href=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&layout=button&size=small&mobile_iframe=true&width=61&height=20&appId" width="61" height="20" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true" allow="encrypted-media"></iframe>
        

        

        
          <a data-pocket-label="pocket" data-pocket-count="none" class="pocket-btn" data-lang="en"></a>
          <script type="text/javascript">!function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");</script>
        

      </div>
    
  

        </aside>
      </div>

      <div id="footer" class="pt-2 pb-3 bg-white text-center">
        

  <span class="text-small text-gray">
    Â© Matteo Guadrini &middot; 

    Powered by the
    <a href="https://github.com/qqhann/hugo-primer" class="link-gray-dark">Hugo-Primer</a> theme for
    <a href="https://gohugo.io" class="link-gray-dark">Hugo</a>.
  </span>


      </div>
    </div>

    
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>
    
  </body>
</html>
